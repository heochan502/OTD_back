<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.otd.onetoday_back.health.HealthLogMapper">

    <!--    건강기록 추가하기 -->
    <insert id="saveHealthLog">
        INSERT INTO healthlog
            SET member_no = #{memberId}
            , weight = #{weight}
            , height = #{height}
            ,systolic_bp = #{systolicBp}
            ,diastolic_bp = #{diastolicBp}
            ,sugar_level = #{sugarLevel}
            ,mood_level = #{moodLevel}
            ,sleep_quality = #{sleepQuality}
            ,healthlog_datetime = #{healthlogDatetime}
    </insert>

    <!--    건강기록 상세 조회 -->
    <select id="findByHealthlogId">
        SELECT *
        FROM healthlog
        WHERE healthlog_id = #{healthlogId}
        AND member_no = #{memberId}
    </select>

    <!--    건강기록 조회-->
    <select id="findAllByMemberIdOrderByhealthlogDatetimeDesc">
        SELECT *
        FROM healthlog
        WHERE member_no = #{memberId} AND healthlog_datetime BETWEEN #{startDate} AND #{endDate}
        ORDER BY healthlog_datetime DESC
    </select>

<!--    건강기록 리스트 조회 -->
    <select id="findByLimitTo">
    SELECT healthlog_datetime
    FROM healthlog
    WHERE member_no = #{memberId}
    ORDER BY healthlog_datetime DESC
    <if test="startIdx != null and size != null">
        LIMIT #{startIdx}, #{size}
    </if>
    </select>

<!--    건강기록 달력 날짜 -->
    <select id="findAllByHealthLogDatetime">
        SELECT healthlog_datetime
        FROM healthlog
        WHERE member_no = #{memberId}
        AND healthlog_datetime BETWEEN #{start} AND #{end}
    </select>



    <!--    건강기록 삭제-->
    <delete id="deleteByHealthlogId">
        DELETE FROM healthlog
        WHERE healthlog_id = #{healthlogId}
        AND member_no = #{memberId}
    </delete>

</mapper>
